---
layout: post

title: "Neur2SP"

subtitle: ""

header-img: "img/home-bg-art.jpg"

header-mask: 0.2

published: true

tags:

- L20

---

# Note for Neur2SP: Neural Two-Stage Stochastic Programming

## Introduction

### Two-stage Stochastic Programming 

<img src="https://github.com/xiong-p/xiong-p.github.io/raw/master/_posts/2023/5/Neur2SP/assets/image-20230522103622929.png" alt="image-20230522103622929" style="zoom:50%;" />

<img src="https://github.com/xiong-p/xiong-p.github.io/raw/master/_posts/2023/5/Neur2SP/assets/image-20230522105437571.png" alt="image-20230522105437571" style="zoom:50%;" />

One of the biggest challenging for solving the two-stage stochastic programming is to evaluatie the expected second stage cost, where the second stage decision can involve some uncertainty. It is oftenly used to model the real problem like the following:

- make the first stage decision
- a given scienario happens
- decide the second stage variable
- the objecitve in all is to minimize the cost of the first stage decision and the expected cost for the second stage decision (since we have uncertainty involved, and before thing happening, we can only evaluate the expectation)

**Remark**: Recourse is the ability to take corrective action after a random event has taken place. And complete recourse

### Sample Average Approximation

Since evaluting the expectation of the second stage function is intractable, people usually use the method Sample Average Approximation to approximate it.

<img src="https://github.com/xiong-p/xiong-p.github.io/raw/master/_posts/2023/5/Neur2SP/assets/image-20230522105616541.png" alt="image-20230522105616541" style="zoom:50%;" />

### Extended Form

We can explicitly writing out the second stage decision variable, then the 2SP looks like a nested optimization problem. And we can observe that when $ K $ is fixed, 

<img src="https://github.com/xiong-p/xiong-p.github.io/raw/master/_posts/2023/5/Neur2SP/assets/image-20230522105848191.png" alt="image-20230522105848191" style="zoom:50%;" />